<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>portfolio_sql.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Piotr Lemancewicz</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="GARCH_practise.html">GARCH models comparison</a>
</li>
<li>
  <a href="portfolio_sql.html">MySQL practise</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="mysql-practise---piotr-lemancewicz" class="section level1">
<h1>MySQL Practise - Piotr Lemancewicz</h1>
<p><strong>1. Retrieve First name and Last name of all employees.</strong></p>
<pre class="sql"><code>USE sql_hr; 
SELECT 
    concat(first_name,&#39; &#39;,last_name) AS &#39;Employee name&#39;
FROM employees
ORDER BY first_name;</code></pre>
<p><img src="2019-10-14-13-42-47.png" /></p>
<p><strong>2. Retrieve id and last name of employees who draw a salary which is at least 70000 and who work in office in Minneapolis. Retrieve also office’s address.</strong></p>
<pre class="sql"><code>USE sql_hr;
SELECT 
    e.employee_id AS &#39;Employee ID&#39;,
    e.last_name AS &#39;Last Name&#39;,
    o.address AS &#39;Office address&#39;
FROM employees e 
JOIN offices o
    USING (office_id)
    WHERE office_id = (
        SELECT office_id
        FROM offices
        WHERE city = &#39;Minneapolis&#39;)
    AND salary &gt;= 70000;</code></pre>
<p><img src="2019-10-14-13-44-32.png" /></p>
<p><strong>3. Make aprioriate changes concerning situation: Employee with id 84791 no longer reports to anyone and all employees from office id 4 will from now on report to that employee with id 84791.</strong></p>
<pre class="sql"><code>USE sql_hr;
UPDATE employees
SET 
    reports_to = NULL
WHERE employee_id = 84791;

UPDATE employees
SET 
    reports_to = 84791
WHERE reports_to IS NOT NULL AND office_id = 4;</code></pre>
<p><strong>4. Retrieve the id of the invoice and a year in which it is due.</strong></p>
<pre class="sql"><code>USE sql_invoicing;
SELECT 
    invoice_id, 
    YEAR(due_date)
FROM invoices;</code></pre>
<p><img src="2019-10-14-13-48-27.png" /></p>
<p><strong>5. Display first name, last name and phone number of customers who live in Atlanta or Nashville and have over 1000 points.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    first_name,
    last_name,
    phone,
    city,
    points
FROM customers 
WHERE city IN (&#39;Atlanta&#39;,&#39;Nashville&#39;) 
AND points &gt; 1000;</code></pre>
<p><img src="2019-10-14-13-49-15.png" /></p>
<p><strong>6. Display first name, last name and phone number of all customers whose phone number starts with 4.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    first_name,
    last_name,
    phone    
FROM customers 
WHERE phone LIKE &#39;4%&#39;;</code></pre>
<p><img src="2019-10-14-13-49-39.png" /></p>
<p><strong>7. Retrieve first name and last name of customers whose address have word ‘center’ in it.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    first_name,
    last_name
FROM customers 
WHERE address LIKE &#39;%center%&#39;;</code></pre>
<p><img src="2019-10-14-13-50-37.png" /></p>
<p><strong>8. Retrieve the id and birth date of customers who have been born betwen 1986 and 1992.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    customer_id, 
    birth_date
FROM customers 
WHERE birth_date BETWEEN &#39;1986-01-01&#39; AND &#39;1992-01-01&#39;;</code></pre>
<p><img src="2019-10-14-13-51-35.png" /></p>
<p><strong>9. Retrieve the id and birth date of customers who have NOT been born betwen 1986 and 1992 and are NOT from Nashville.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    customer_id, 
    birth_date
FROM customers 
WHERE birth_date NOT BETWEEN &#39;1986-01-01&#39; AND &#39;1992-01-01&#39;
AND city &lt;&gt; &#39;Nashville&#39;;</code></pre>
<p><img src="2019-10-14-13-52-20.png" /></p>
<p><strong>10. Display id and unit prices of products from order with id = 2, sorted by their unit price in descending mode.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    product_id,
    unit_price
FROM order_items
WHERE order_id = 2
ORDER BY unit_price DESC;</code></pre>
<p><img src="2019-10-14-13-52-57.png" /></p>
<p><strong>11. Display the average order value and total order value for each id of all orders.</strong></p>
<pre class="sql"><code>USE sql_store; 
SELECT
        order_id,
        SUM(quantity*unit_price) AS order_value
    FROM order_items
    GROUP BY order_id
    ORDER BY order_value DESC;</code></pre>
<p><img src="2019-10-14-13-54-08.png" /></p>
<pre class="sql"><code>SELECT
AVG (order_value) AS &#39;Average Order Value&#39;
FROM (SELECT
        order_id,
        SUM(quantity*unit_price) AS order_value
    FROM order_items
    GROUP BY order_id
    ORDER BY order_value DESC) AS X;</code></pre>
<p><img src="2019-10-14-13-54-25.png" /></p>
<p><strong>12. Indicate (in comments) that customers, who have more than 3000 points and ordered something, are Gold customers.</strong></p>
<pre class="sql"><code>USE sql_store;
UPDATE orders 
SET comments = &#39;Gold customer&#39;
WHERE customer_id IN
    (SELECT customer_id
    FROM customers
    WHERE points &gt; 3000);</code></pre>
<p><strong>13. Display addresses of those departments that has at least 3 employees.</strong></p>
<pre class="sql"><code>USE sql_hr;
SELECT 
    e.office_id,
    o.address AS &#39;office address&#39;,
    COUNT(*) AS &#39;Number of employees&#39;
FROM employees e
JOIN offices o 
    USING (office_id) 
GROUP BY office_id
HAVING COUNT(*) &gt;= 3;</code></pre>
<p><img src="2019-10-14-13-56-34.png" /></p>
<p><strong>14. Display orders before 2019-01-01 as Active and those after 2019-01-01 as Archived orders.</strong></p>
<pre class="sql"><code>USE sql_store;
SELECT 
    order_id,
    order_date,
    &#39;Active&#39; AS status
FROM orders
WHERE order_date &gt;= &#39;2019-01-01&#39;
UNION
SELECT 
    order_id,
    order_date,
    &#39;Archived&#39; AS status
FROM orders
WHERE order_date &lt; &#39;2019-01-01&#39;;</code></pre>
<p><img src="2019-10-14-13-59-10.png" /></p>
<p><strong>15. Display status of orders.</strong></p>
<pre class="sql"><code>USE sql_store;    
SELECT 
    o.order_id,
    o.order_date,
    c.first_name,
    c.last_name,
    os.name AS status
FROM orders o
JOIN customers c 
    ON o.customer_id = c.customer_id
JOIN order_statuses os
    ON o.status = os.order_status_id
ORDER BY order_id;</code></pre>
<p><img src="2019-10-14-13-59-38.png" /></p>
<p><strong>16. Display id and salary of employees whose salary is more than the average salary of all of the employees.</strong></p>
<pre class="sql"><code>USE sql_hr;
SELECT 
    employee_id, 
    salary
FROM employees
WHERE salary &gt;= (SELECT AVG(salary) FROM employees);</code></pre>
<p><img src="2019-10-14-14-00-13.png" /></p>
<p><strong>17. Find the 2nd lowest salary in the employees table.</strong></p>
<pre class="sql"><code>USE sql_hr;
SELECT 
    min(salary) AS &#39;2nd lowest salary&#39;
FROM employees 
WHERE salary NOT IN ( 
    SELECT 
        MIN(salary) 
    FROM employees);</code></pre>
<p><img src="2019-10-14-14-00-34.png" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
